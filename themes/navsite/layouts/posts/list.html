{{ define "main" }}
{{ $p := .Paginate .Pages 10 }}
{{ $firstPost := index $p.Pages 0 }}

<div class="blog-layout">
  <aside class="blog-sidebar">
    <div class="panel">
      <h2 class="blog-sidebar__title">最近文章</h2>
      <nav class="blog-sidebar__list">
        {{ range $p.Pages }}
          <a class="blog-sidebar__item {{ if eq .RelPermalink $firstPost.RelPermalink }}is-active{{ end }}" href="{{ .RelPermalink }}">
            <div class="blog-sidebar__item-title">{{ .Title }}</div>
            <div class="blog-sidebar__item-meta">
              <time>{{ .Date.Format "2006-01-02" }}</time>
            </div>
          </a>
        {{ end }}
      </nav>
      {{ if gt $p.TotalPages 1 }}
        <div class="blog-sidebar__pagination">
          {{ if $p.HasPrev }}<a class="ghost-link" href="{{ $p.Prev.URL }}">上一页</a>{{ end }}
          <span class="blog-pagination__info">第 {{ $p.PageNumber }} / {{ $p.TotalPages }} 页</span>
          {{ if $p.HasNext }}<a class="ghost-link" href="{{ $p.Next.URL }}">下一页</a>{{ end }}
        </div>
      {{ end }}
    </div>
  </aside>

  <main class="blog-content">
    {{ if $firstPost }}
      <article class="panel blog-post">
        <header class="blog-post__header">
          <h1 class="blog-post__title">{{ $firstPost.Title }}</h1>
          <div class="blog-post__meta">
            <time datetime="{{ $firstPost.Date.Format "2006-01-02" }}">{{ $firstPost.Date.Format "2006-01-02" }}</time>
            {{ with $firstPost.Params.tags }}
              <span class="blog-post__tags">
                {{ range . }}<a class="tag-badge" href="{{ (printf "/tags/%s/" (urlize .)) | relURL }}">{{ . }}</a>{{ end }}
              </span>
            {{ end }}
          </div>
          {{ with $firstPost.Params.summary }}<p class="blog-post__subtitle">{{ . }}</p>{{ end }}
        </header>

        <div class="prose">
          {{ $firstPost.Content }}
        </div>
      </article>
    {{ else }}
      <div class="panel">
        <p>暂无文章</p>
      </div>
    {{ end }}
  </main>
</div>
{{ end }}


